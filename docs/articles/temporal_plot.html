<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="DUToolkit">
<title>Temporal probability density plots • DUToolkit</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Temporal probability density plots">
<meta property="og:description" content="DUToolkit">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light" data-bs-theme="light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">DUToolkit</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.2</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../articles/DUToolkit.html">Get started</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/Calculating_Risk.html">Calculating Risk</a>
    <a class="dropdown-item" href="../articles/Fan_Plots.html">Time-outcome fan plots</a>
    <a class="dropdown-item" href="../articles/density_plots.html">Probability density plots with risk shading</a>
    <a class="dropdown-item" href="../articles/rain_plot.html">Raincloud plots</a>
    <a class="dropdown-item" href="../articles/temporal_plot.html">Temporal probability density plots</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav"></ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Temporal probability density plots</h1>
            
      
      
      <div class="d-none name"><code>temporal_plot.Rmd</code></div>
    </div>

    
    
<p>Decision-makers may also want to consider how risk changes over the
modelled time range. To do this, we plot the probability densities over
time. The probability density of the highest (or lowest if the threshold
is a minimum) projected outcome across simulation runs is plotted in the
center of the graph for a given policy alternative. Above and below, the
probability density of the outcome at specified time points relative to
the time of the highest (or lowest) project outcome is plotted to
visually illustrate how uncertainty, and therefore risk, changes over
time. The decision threshold is shown directly on the plot as a vertical
line to provide a clear reference point for interpreting the
outputs.</p>
<p>First, we find the model output value at the specified time points
relative to the peak value for each simulation run using the
<code><a href="../reference/get_relative_values.html">get_relative_values()</a></code> function. In our example, we will
find the hospital demand every ten days for up to 20 days before and
after the peak hospital demand.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># define inputs</span></span>
<span><span class="va">tmin</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">psa_data</span><span class="op">$</span><span class="va">Intervention_1</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span><span class="op">)</span> <span class="co"># minimum simulation time</span></span>
<span><span class="va">tmax</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">psa_data</span><span class="op">$</span><span class="va">Intervention_1</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span><span class="op">)</span> <span class="co"># maximum simulation time</span></span>
<span><span class="va">Dt_max</span> <span class="op">&lt;-</span> <span class="cn">TRUE</span> <span class="co"># indicates the threshold values are maximums</span></span>
<span><span class="va">D</span> <span class="op">&lt;-</span> <span class="fl">750</span> <span class="co"># single threshold value for the peak</span></span>
<span><span class="va">t_s</span> <span class="op">&lt;-</span> <span class="fl">20</span> <span class="co"># total number of time steps from the peak</span></span>
<span><span class="va">t_ss</span> <span class="op">&lt;-</span> <span class="fl">10</span> <span class="co"># time step increments to move in</span></span>
<span></span>
<span><span class="co">## find peak values</span></span>
<span><span class="va">peak_values_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_max_min_values.html">get_max_min_values</a></span><span class="op">(</span><span class="va">psa_data</span>, <span class="va">tmin</span>, <span class="va">tmax</span>, <span class="va">Dt_max</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># find values for temporal density plots</span></span>
<span><span class="va">peak_temporal_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_relative_values.html">get_relative_values</a></span><span class="op">(</span><span class="va">psa_data</span>, <span class="va">peak_values_list</span>, <span class="va">t_s</span>, <span class="va">t_ss</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">peak_temporal_list</span><span class="op">$</span><span class="va">Baseline</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="co">#&gt;   time  outcome N</span></span>
<span><span class="co">#&gt; 1 peak 4207.443 1</span></span>
<span><span class="co">#&gt; 2 peak 1681.521 2</span></span>
<span><span class="co">#&gt; 3 peak 2539.177 3</span></span>
<span><span class="co">#&gt; 4 peak 2969.721 4</span></span>
<span><span class="co">#&gt; 5 peak 3073.741 5</span></span>
<span><span class="co">#&gt; 6 peak 1520.144 6</span></span></code></pre></div>
<p>We then use the <code><a href="../reference/plot_temporal.html">plot_temporal()</a></code> function to generate the
temporal probability density plots.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># generate peak temporal density plots</span></span>
<span><span class="va">peak_temporal_plots</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plot_temporal.html">plot_temporal</a></span><span class="op">(</span><span class="va">peak_temporal_list</span>, <span class="va">D</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## example plot</span></span>
<span><span class="va">peak_temporal_plots</span><span class="op">$</span><span class="va">Baseline</span></span></code></pre></div>
<p><img src="temporal_plot_files/figure-html/gen_plot_temp-1.png" width="100%">
The <code><a href="../reference/sum_stats_temporal.html">sum_stats_temporal()</a></code> function can be used to calculate
summary statistics (n, mean, median, and IQR) for the model output
values at the time step relative to the peak value.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># generate summary statistics for peak temporal data</span></span>
<span><span class="va">stats_peak_temporal</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/sum_stats_temporal.html">sum_stats_temporal</a></span><span class="op">(</span><span class="va">peak_temporal_list</span><span class="op">)</span></span>
<span></span>
<span><span class="va">stats_peak_temporal</span><span class="op">$</span><span class="va">Baseline</span></span>
<span><span class="co">#&gt;   time_step   n      q1  median    mean      q3</span></span>
<span><span class="co">#&gt; 1   peak-20 813   90.32  136.99  157.21  210.21</span></span>
<span><span class="co">#&gt; 2   peak-10 813  738.29 1013.14 1005.52 1260.49</span></span>
<span><span class="co">#&gt; 3      peak 813 1520.14 2300.14 2247.85 2982.81</span></span>
<span><span class="co">#&gt; 4   peak+10 813  884.80 1246.00 1211.20 1548.80</span></span>
<span><span class="co">#&gt; 5   peak+20 813  247.77  326.34  338.76  418.55</span></span></code></pre></div>
<div class="section level3">
<h3 id="temp-outputs">Sharing outputs<a class="anchor" aria-label="anchor" href="#temp-outputs"></a>
</h3>
<p>The probability density plotted in the center of the peak temporal
plot (labelled ‘peak’) is the same probability density that is plotted
with <code><a href="../reference/plot_density.html">plot_density()</a></code> function and
<code><a href="../reference/plot_raincloud.html">plot_raincloud()</a></code> function. The temporal probability density
plots can further supplement these probability density plots by showing
how uncertainty changes over time for each scenario.</p>
<p>We also recommend the following standard description for presenting
the temporal probability density plots to decision-makers. We provide
the standard description in paragraph and bullet point form for ease of
use.</p>
<div class="section level4">
<h4 id="temp_sd">Standard description<a class="anchor" aria-label="anchor" href="#temp_sd"></a>
</h4>
<div class="rmdnote">
<p>These graph visually illustrates how uncertainty changes over time by
showing the distributions of the forecasted <u><em>outcome</em></u><a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content="&lt;p&gt;insert outcome description (ex. hospital demand)&lt;/p&gt;"><sup>1</sup></a> over time.
The distribution in the center of the plot represents the
<u><em>peak</em></u><a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content="&lt;p&gt;if threshold is a minimum replace with &lt;em&gt;low
point&lt;/em&gt;&lt;/p&gt;"><sup>2</sup></a> <u><em>outcome</em></u><a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content="&lt;p&gt;insert outcome description (ex. hospital demand)&lt;/p&gt;"><sup>3</sup></a>. The distributions
above and below show the outcome at different time points relative to
the <u><em>peak</em></u><a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content="&lt;p&gt;if threshold is a minimum replace with &lt;em&gt;low
point&lt;/em&gt;&lt;/p&gt;"><sup>4</sup></a>, both forward (above) and backward (below)
in time.</p>
<p>The red dashed line indicates the policy target. A greater area to
the <u><em>right</em></u><a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content="&lt;p&gt;if threshold is a minimum replace with &lt;em&gt;left&lt;/em&gt;&lt;/p&gt;"><sup>5</sup></a> of this line means a higher risk of
<u><em>outcome</em></u><a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content="&lt;p&gt;insert outcome description (ex. hospital demand)&lt;/p&gt;"><sup>6</sup></a> <u><em>exceeding</em></u><a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content="&lt;p&gt;if threshold is a minimum replace with &lt;em&gt;falling
below&lt;/em&gt;&lt;/p&gt;"><sup>7</sup></a> the policy target at
the specified time. Scenarios where the area to the
<u><em>right</em></u><a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content="&lt;p&gt;if threshold is a minimum replace with &lt;em&gt;left&lt;/em&gt;&lt;/p&gt;"><sup>8</sup></a> of the policy target is more quickly
reduced as you move away from the <u><em>peak</em></u><a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content="&lt;p&gt;if threshold is a minimum replace with &lt;em&gt;low
point&lt;/em&gt;&lt;/p&gt;"><sup>9</sup></a> result in a shorter
periods of time at higher risk of not achieving the policy target.</p>
</div>
</div>
<div class="section level4 unnumbered">
<h4 class="unnumbered" id="standard-description-bullet-points">Standard description bullet points<a class="anchor" aria-label="anchor" href="#standard-description-bullet-points"></a>
</h4>
<div class="rmdnote">
<p>These graphs visually illustrates how uncertainty changes over
time:</p>
<ul>
<li><p>The distribution in the center of the plot represents the
<u><em>peak</em></u><a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content="&lt;p&gt;if threshold is a minimum replace with &lt;em&gt;low
point&lt;/em&gt;&lt;/p&gt;"><sup>10</sup></a> <u><em>outcome</em></u><a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content="&lt;p&gt;insert outcome description (ex. hospital demand)&lt;/p&gt;"><sup>11</sup></a>.</p></li>
<li><p>The distributions above and below show the outcome at different
time points relative to the <u><em>peak</em></u><a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content="&lt;p&gt;if threshold is a minimum replace with &lt;em&gt;low
point&lt;/em&gt;&lt;/p&gt;"><sup>12</sup></a>, both forward
(above) and backward (below) in time.</p></li>
<li><p>The red dashed line indicates the policy target.</p></li>
<li><p>A greater area to the <u><em>right</em></u><a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content="&lt;p&gt;if threshold is a minimum replace with &lt;em&gt;left&lt;/em&gt;&lt;/p&gt;"><sup>13</sup></a> of this line means a
higher chance of the <u><em>outcome</em></u><a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content="&lt;p&gt;insert outcome description (ex. hospital demand)&lt;/p&gt;"><sup>14</sup></a>
<u><em>exceeding</em></u><a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content="&lt;p&gt;if threshold is a minimum replace with &lt;em&gt;falling
below&lt;/em&gt;&lt;/p&gt;"><sup>15</sup></a> the policy target at the specified
time.</p></li>
<li><p>Scenarios where the area to the <u><em>right</em></u><a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content="&lt;p&gt;if threshold is a minimum replace with &lt;em&gt;left&lt;/em&gt;&lt;/p&gt;"><sup>16</sup></a> of the
policy target is more quickly reduced as you move away from the
<u><em>peak</em></u><a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content="&lt;p&gt;if threshold is a minimum replace with &lt;em&gt;low
point&lt;/em&gt;&lt;/p&gt;"><sup>17</sup></a> result in a shorter time frame of higher
uncertainty.</p></li>
</ul>
</div>
</div>
</div>

  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Megan Wiggins, Marie Betsy Varughese, Ellen Rafferty, Sasha van Katwyk, Christopher McCabe, Jeff Round, Erin Kirwin, Institute of Health Economics, Canadian Network for Modelling Infectious Diseases .</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.8.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>

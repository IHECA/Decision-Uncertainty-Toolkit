<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="DUToolkit">
<title>Time-outcome fan plots • DUToolkit</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Time-outcome fan plots">
<meta property="og:description" content="DUToolkit">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light" data-bs-theme="light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">DUToolkit</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.2</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../articles/DUToolkit.html">Get started</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/Calculating_Risk.html">Calculating Risk</a>
    <a class="dropdown-item" href="../articles/Fan_Plots.html">Time-outcome fan plots</a>
    <a class="dropdown-item" href="../articles/density_plots.html">Probability density plots with risk shading</a>
    <a class="dropdown-item" href="../articles/rain_plot.html">Raincloud plots</a>
    <a class="dropdown-item" href="../articles/temporal_plot.html">Temporal probability density plots</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav"></ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Time-outcome fan plots</h1>
            
      
      
      <div class="d-none name"><code>Fan_Plots.Rmd</code></div>
    </div>

    
    
<p>The DUToolkit includes a series of visual outputs that build upon
those used in health economics. These visuals are designed to facilitate
the intuitive and direct interpretation of model outputs by infectious
disease modellers and decision-makers. The visual and numerical
presentation of decision risk are designed as complementary outputs to
support decision-makers’ deliberations.</p>
<p>Time-outcome fan plots are the first of these visuals. In these
plots, the trajectory of the outcome is summarized over time and plotted
using the mean value for a given policy alternative. Uncertainty is
characterized by shading the 50% and 95% credible intervals (calculated
as 25th and 75th percentiles and 2.5th and 97.5th percentiles,
respectively). The decision threshold is shown directly on the plot to
provide a clear reference point for interpreting the outcome values.</p>
<p>We generate the fan plots for each policy alternative using the
<code><a href="../reference/plot_fan.html">plot_fan()</a></code> function.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># define inputs</span></span>
<span><span class="va">tmin</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">psa_data</span><span class="op">$</span><span class="va">Intervention_1</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span><span class="op">)</span> <span class="co"># minimum simulation time</span></span>
<span><span class="va">tmax</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">psa_data</span><span class="op">$</span><span class="va">Intervention_1</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span><span class="op">)</span> <span class="co"># maximum simulation time</span></span>
<span><span class="va">Dt</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">750</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">tmin</span><span class="op">:</span><span class="va">tmax</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="co"># decision threshold vector</span></span>
<span><span class="va">Dt_max</span> <span class="op">&lt;-</span> <span class="cn">TRUE</span> <span class="co"># indicates the threshold values are maximums</span></span>
<span></span>
<span><span class="co"># generate fan plots</span></span>
<span><span class="va">fan_plots</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plot_fan.html">plot_fan</a></span><span class="op">(</span><span class="va">psa_data</span>, <span class="va">tmin</span>, <span class="va">tmax</span>, <span class="va">Dt</span>, <span class="va">Dt_max</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## example plot</span></span>
<span><span class="va">fan_plots</span><span class="op">$</span><span class="va">Baseline</span></span></code></pre></div>
<p><img src="Fan_Plots_files/figure-html/gen_fan-1.png" width="100%"></p>
<p>All plotting functions in the DUToolkit return ggplot2 objects. You
can adjust/customize the plots after they have been generated (<a href="https://rstudio.github.io/cheatsheets/html/data-visualization.html" class="external-link">ggplot2
cheat sheet</a>).</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># customize plots</span></span>
<span><span class="co">## add fixed y-axis limits and change the label of the y-axis</span></span>
<span><span class="va">fan_plots</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">fan_plots</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">x</span> <span class="op">+</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/lims.html" class="external-link">ylim</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">4000</span><span class="op">)</span> <span class="op">+</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>y <span class="op">=</span> <span class="st">"Hospital Demand"</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## remove subtitle and caption</span></span>
<span><span class="va">fan_plots</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">fan_plots</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">x</span> <span class="op">+</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>subtitle <span class="op">=</span> <span class="cn">NULL</span>, caption <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## example plot</span></span>
<span><span class="va">fan_plots</span><span class="op">$</span><span class="va">Baseline</span></span></code></pre></div>
<p><img src="Fan_Plots_files/figure-html/cust_fan-1.png" width="100%"></p>
<p>The <code><a href="../reference/calculate_time.html">calculate_time()</a></code> function is used within
<code><a href="../reference/plot_fan.html">plot_fan()</a></code> to determine the uncertainty in the timing and
duration of threshold exceedances, which are then displayed in the plot
subtitle. Additionally, <code><a href="../reference/calculate_time.html">calculate_time()</a></code> can be used
independently to generate results in a tabular format without creating
fan plots. Its outputs include:</p>
<ol style="list-style-type: decimal">
<li><p>Percent of simulations in which the threshold is exceeded (or not
met if the threshold is a minimum).</p></li>
<li><p>Mean simulation time of the first exceedance and 95th percentile
range.</p></li>
<li><p>Mean duration of the first exceedance and 95th percentile
range.</p></li>
<li><p>If the first column of the model output passed to the function is
a Date, the mean date of the first and last exceedance.</p></li>
</ol>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Find mean and 95%CI of time and duration of first violation of the threshold</span></span>
<span><span class="va">time_outcomes_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/calculate_time.html">calculate_time</a></span><span class="op">(</span><span class="va">psa_data</span>, <span class="va">tmin</span>, <span class="va">tmax</span>, <span class="va">Dt</span>, <span class="va">Dt_max</span><span class="op">)</span></span>
<span><span class="va">time_outcomes_list</span><span class="op">$</span><span class="va">Baseline</span></span>
<span><span class="co">#&gt;     percent_sims time_first 2.5% 97.5% duration_first 2.5% 97.5% date_first</span></span>
<span><span class="co">#&gt; out    0.9532595   22.88516   16    35       25.03484    9    34 2021-01-23</span></span>
<span><span class="co">#&gt;      date_last</span></span>
<span><span class="co">#&gt; out 2021-02-17</span></span></code></pre></div>
<div class="section level3">
<h3 id="fan-outputs">Sharing outputs<a class="anchor" aria-label="anchor" href="#fan-outputs"></a>
</h3>
<p>These plots visually illustrate the uncertainty in the outcome (in
this case, hospital demand) for each policy and facilitate assessment in
relation to the decision threshold (hospital capacity). They can be used
to visually assess the probability of exceeding the threshold and to
understand the expected magnitude, timing, and duration of any
exceedances. These plots should be presented alongside the risk measures
to provide decision-makers with a quantitative measure of the risk
associated with each policy, alongside a visual representation of
uncertainty for additional context.</p>
<p>We also recommend the following standard description for presenting
the time-outcome fan plots to decision-makers. We provide the standard
description in paragraph and bullet point form for ease of use.</p>
<div class="section level4 unnumbered">
<h4 class="unnumbered" id="standard-description">Standard description<a class="anchor" aria-label="anchor" href="#standard-description"></a>
</h4>
<div class="rmdnote">
<p>These graphs visually displays the uncertainty surrounding the
scenario’s <strong>probability</strong> of <u><em>exceeding</em></u><a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content="&lt;p&gt;if threshold is a minimum replace with &lt;em&gt;falling
below&lt;/em&gt;&lt;/p&gt;"><sup>1</sup></a> the
specified policy target. They indicate not only the degree of
uncertainty but also provides insight into the
<strong>magnitude</strong> by which the intervention is likely to
<u><em>exceed</em></u><a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content="&lt;p&gt;if threshold is a minimum replace with &lt;em&gt;fall
below&lt;/em&gt;&lt;/p&gt;"><sup>2</sup></a> the target (through percentile shading) and
the anticipated <strong>duration</strong> of the
<u><em>exceedance</em></u><a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content="&lt;p&gt;if threshold is a minimum replace with &lt;em&gt;short
fall&lt;/em&gt;&lt;/p&gt;"><sup>3</sup></a>.</p>
<p>The <strong>magnitude</strong> and the <strong>length of
time</strong> that the shaded areas <u><em>extends beyond</em></u><a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content="&lt;p&gt;if threshold is a minimum replace with &lt;em&gt;falls
below&lt;/em&gt;&lt;/p&gt;"><sup>4</sup></a> the policy
target (dashed red line) signifies the risk that the scenario will not
achieve the policy objective. More shaded area <u><em>above</em></u><a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content="&lt;p&gt;if threshold is a minimum replace with &lt;em&gt;below&lt;/em&gt;&lt;/p&gt;"><sup>5</sup></a> the dashed
red line for longer periods indicates a higher risk of not achieving the
policy objective.</p>
</div>
</div>
<div class="section level4 unnumbered">
<h4 class="unnumbered" id="standard-description-bullet-points">Standard description bullet points<a class="anchor" aria-label="anchor" href="#standard-description-bullet-points"></a>
</h4>
<div class="rmdnote">
<p>These graphs visually display:</p>
<ul>
<li><p>The uncertainty surrounding the scenario’s
<strong>probability</strong> of <u><em>exceeding</em></u><a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content="&lt;p&gt;if threshold is a minimum replace with &lt;em&gt;falling
below&lt;/em&gt;&lt;/p&gt;"><sup>6</sup></a> the specified policy
target.</p></li>
<li><p>They also provides insight into the <strong>magnitude</strong> by
which the intervention is likely to <u><em>exceed</em></u><a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content="&lt;p&gt;if threshold is a minimum replace with &lt;em&gt;fall
below&lt;/em&gt;&lt;/p&gt;"><sup>7</sup></a> the target (through
percentile shading) and the anticipated <strong>duration</strong> of the
<u><em>exceedance</em></u><a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content="&lt;p&gt;if threshold is a minimum replace with &lt;em&gt;short
fall&lt;/em&gt;&lt;/p&gt;"><sup>8</sup></a>.</p></li>
<li><p>The <strong>magnitude</strong> and the <strong>length of
time</strong> that the shaded areas <u><em>extends beyond</em></u><a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content="&lt;p&gt;if threshold is a minimum replace with &lt;em&gt;falls
below&lt;/em&gt;&lt;/p&gt;"><sup>9</sup></a> the policy
target (dashed red line) signifies the risk that the scenario will not
achieve the policy objective.</p></li>
<li><p>More shaded area <u><em>above</em></u><a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content="&lt;p&gt;if threshold is a minimum replace with &lt;em&gt;below&lt;/em&gt;&lt;/p&gt;"><sup>10</sup></a> the dashed red line
for longer periods indicates a higher risk of not achieving the policy
objective.</p></li>
</ul>
</div>
</div>
</div>

  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Megan Wiggins, Marie Betsy Varughese, Ellen Rafferty, Sasha van Katwyk, Christopher McCabe, Jeff Round, Erin Kirwin, Institute of Health Economics, Canadian Network for Modelling Infectious Diseases .</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.8.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>

<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="DUToolkit">
<title>Calculating Risk • DUToolkit</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Calculating Risk">
<meta property="og:description" content="DUToolkit">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light" data-bs-theme="light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">DUToolkit</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.2</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../articles/DUToolkit.html">Get started</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/Calculating_Risk.html">Calculating Risk</a>
    <a class="dropdown-item" href="../articles/Fan_Plots.html">Time-outcome fan plots</a>
    <a class="dropdown-item" href="../articles/density_plots.html">Probability density plots with risk shading</a>
    <a class="dropdown-item" href="../articles/rain_plot.html">Raincloud plots</a>
    <a class="dropdown-item" href="../articles/temporal_plot.html">Temporal probability density plots</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav"></ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Calculating Risk</h1>
            
      
      
      <div class="d-none name"><code>Calculating_Risk.Rmd</code></div>
    </div>

    
    
<p>Decisions can be defined via stated policy objectives. In our example
the policy objective is to ensure that the number of individuals
requiring hospitalization remains below the available hospital capacity.
The stated policy objective establishes the criteria for differentiating
between policy successes and failures. For example, exceeding hospital
capacity is more undesirable than not exceeding it. Therefore, the
stated policy objective acts as a threshold against which risks can be
evaluated. Risk can be measured in terms of the probability of an
undesirable outcome occurring (i.e., exceeding the policy objective),
the magnitude of deviations from the stated policy objective, and the
duration of these deviations.</p>
<div class="section level2">
<h2 id="risk-form">Formula<a class="anchor" aria-label="anchor" href="#risk-form"></a>
</h2>
<p>The expected risk for each policy alternative can be estimated using
the outputs from multiple model runs with different input parameter
sets, as outlined in the box below. Additionally, a weighted version of
this formula, which accounts for simulation runs with different weights,
is provided.</p>
<p>The expected risk is calculated over a pre-defined time range (<span class="math inline">\(t = t_{\rm min}…t_{\rm max}\)</span>), which
should be selected to capture important features of the decision
problem, such as the maximum duration for which any of the policy
options being considered might be adopted. The decision threshold (<span class="math inline">\(D_{\rm t}\)</span>) can be either a maximum, such
as a maximum hospital capacity, or a minimum, such as a target number of
vaccinations to be delivered. The decision threshold (<span class="math inline">\(D_{\rm t}\)</span>) can also have different values
for different time periods if, for example, the hospital capacity is
expected to change over time. To ensure a consistent basis for
comparison, it is important that all decision threshold (<span class="math inline">\(D_{\rm t}\)</span>) values, the total number of
simulations (<span class="math inline">\(N\)</span>), and the time range
(<span class="math inline">\(t = t_{\rm min}…t_{\rm max}\)</span>) are
consistent across the baseline scenario and each of the policy
alternatives being compared.</p>
<div class="section level4">
<h4 id="risk-measure-formula">Risk measure formula<a class="anchor" aria-label="anchor" href="#risk-measure-formula"></a>
</h4>
<div class="rmdnote">
<p><span class="math display">\[
{\small
\textrm{Expected Risk} =
  \begin{cases}
  \frac{1}{N} \sum_{n = 1}^{N}  \sum_{t = t_{\rm min}}^{t_{\rm
max}}(\max(D_t, O_{nt})-D_t) &amp;\textrm{if } D_t \textrm{ is a
maximum} \\
  \\\
  \frac{1}{N}\sum_{n = 1}^{N}  \sum_{t = t_{\rm min}}^{t_{\rm max}}(D_t
- \min(D_t, O_{nt})) &amp;\textrm{if } D_t \textrm{ is a minimum}
  \end{cases}
}
\]</span></p>
<p>Where <span class="math inline">\(n = 1…N\)</span> are the number of
simulations runs in the analysis, <span class="math inline">\(t = t_{\rm
min}…t_{\rm max}\)</span> is the simulation time over which the expected
risk is calculated, <span class="math inline">\(O_{\rm nt}\)</span> is
the model outcome result for simulation run <span class="math inline">\(n\)</span> at time <span class="math inline">\(t\)</span>, and <span class="math inline">\(D_{\rm
t}\)</span> is the decision threshold at a given time (the stated policy
objective), which can be a maximum or a minimum.</p>
<p>The Expected Risk value calculation implies the following
assumptions: (i) <strong><em>distribution neutrality of deviations from
Dt:</em></strong> a certain risk of exceeding Dt by 10 has the same
value as a risk distributed equally of an exceedance of either 0 or 20;
and (ii) <strong><em>linearity in cumulative risk:</em></strong> an
exceedance of 1 over 100 days has the same value as an exceedance of 10
over 10 days.</p>
</div>
</div>
<div class="section level4 unnumbered">
<h4 class="unnumbered" id="risk-measure-formula-with-weights">Risk measure formula with weights<a class="anchor" aria-label="anchor" href="#risk-measure-formula-with-weights"></a>
</h4>
<div class="rmdnote">
<p><span class="math display">\[
{\small
\textrm{Expected Risk} =
  \begin{cases}
  \frac{1}{N} \sum_{n = 1}^{N} W_n \times \sum_{t = t_{\rm min}}^{t_{\rm
max}}(\max(D_t, O_{nt})-D_t) &amp;\textrm{if } D_t \textrm{ is a
maximum} \\
  \\\
  \frac{1}{N}\sum_{n = 1}^{N} W_n \times \sum_{t = t_{\rm min}}^{t_{\rm
max}}(D_t - \min(D_t, O_{nt})) &amp;\textrm{if } D_t \textrm{ is a
minimum}
  \end{cases}
}
\]</span></p>
<p>Where <span class="math inline">\(n = 1…N\)</span> are the number of
simulations runs in the analysis, <span class="math inline">\(t = t_{\rm
min}…t_{\rm max}\)</span> is the simulation time, <span class="math inline">\(O_{\rm nt}\)</span> is the model outcome result
for simulation run <span class="math inline">\(n\)</span> at time <span class="math inline">\(t\)</span>, <span class="math inline">\(D_{\rm
t}\)</span> is the decision threshold at a given time (the stated policy
objective), and <span class="math inline">\(W_{\rm n}\)</span> is the
weight value for simulation run <span class="math inline">\(n\)</span>.</p>
</div>
</div>
</div>
<div class="section level2">
<h2 id="risk-calc">Calculating risk with DUToolkit<a class="anchor" aria-label="anchor" href="#risk-calc"></a>
</h2>
<p>First, we calculate the expected risk for each policy alternative
using the <code><a href="../reference/calculate_risk.html">calculate_risk()</a></code> function. The policy objective
is to ensure that hospital demand remains below the available daily
hospital capacity of 750 patients, which defines the decision threshold.
We consider a baseline scenario that represented the expected outcome in
the absence of any intervention (i.e., taking no action) and a
hypothetical policy alternative (Intervention 1 – close schools). We
considered a time range of 100 days starting from 2021-01-01,
corresponding to the first day of policy implementation. We use the
model outputs for 814 simulation runs that incorporate parameter
uncertainty for the baseline scenario and Intervention 1.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># define inputs</span></span>
<span><span class="va">tmin</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">psa_data</span><span class="op">$</span><span class="va">Intervention_1</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span><span class="op">)</span> <span class="co"># minimum simulation time</span></span>
<span><span class="va">tmax</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">psa_data</span><span class="op">$</span><span class="va">Intervention_1</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span><span class="op">)</span> <span class="co"># maximum simulation time</span></span>
<span><span class="va">Dt</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">750</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">tmin</span><span class="op">:</span><span class="va">tmax</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="co"># decision threshold vector</span></span>
<span><span class="va">Dt_max</span> <span class="op">&lt;-</span> <span class="cn">TRUE</span> <span class="co"># indicates the threshold values are maximums</span></span>
<span></span>
<span><span class="co"># calculate risk measure</span></span>
<span><span class="va">risk_measures_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/calculate_risk.html">calculate_risk</a></span><span class="op">(</span><span class="va">psa_data</span>, <span class="va">tmin</span>, <span class="va">tmax</span>, <span class="va">Dt</span>, <span class="va">Dt_max</span><span class="op">)</span></span>
<span></span>
<span><span class="va">risk_measures_list</span></span>
<span><span class="co">#&gt; $Baseline</span></span>
<span><span class="co">#&gt; [1] 23078.21</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $Intervention_1</span></span>
<span><span class="co">#&gt; [1] 2007.469</span></span></code></pre></div>
<p>The expected risk values for each policy alternative are challenging
to interpret independently. A more intuitive understanding can be
achieved by using a pre-defined baseline scenario as a comparator and
calculating the percent change in risk relative to the baseline
scenario. We defined this as the policy risk impact, which can be
calculated for each policy alternative using the
<code><a href="../reference/tabulate_risk.html">tabulate_risk()</a></code> function.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## generate risk table</span></span>
<span><span class="va">risk_table</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/tabulate_risk.html">tabulate_risk</a></span><span class="op">(</span><span class="va">risk_measures_list</span>,</span>
<span>  n_s <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">risk_measures_list</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">risk_table</span></span>
<span><span class="co">#&gt;                    Baseline   Intervention 1</span></span>
<span><span class="co">#&gt; Risk               "23078.21" "2007.47"     </span></span>
<span><span class="co">#&gt; Policy risk impact "-"        "-91.30%"</span></span></code></pre></div>
<div class="section level3">
<h3 id="risk-outputs">Sharing outputs<a class="anchor" aria-label="anchor" href="#risk-outputs"></a>
</h3>
<p>In most cases, the risk table should not be presented alone but
should be accompanied by the plots described in the other vignettes to
provide additional context.</p>
<p>We also recommend the following standard description for presenting
the risk table to decision-makers. We provide the standard description
in paragraph and bullet point form for ease of use.</p>
<div class="section level4 unnumbered">
<h4 class="unnumbered" id="standard-description">Standard description<a class="anchor" aria-label="anchor" href="#standard-description"></a>
</h4>
<div class="rmdnote">
<p>The expected risk values in the first row of the table above capture
the <strong>probability</strong> of the scenario
<u><em>exceeding</em></u><a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content="&lt;p&gt;if threshold is a minimum replace with &lt;em&gt;falling
below&lt;/em&gt;&lt;/p&gt;"><sup>1</sup></a> the specified policy target (i.e., how
likely it is), the <strong>magnitude</strong> of the
<u><em>exceedance</em></u><a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content="&lt;p&gt;if threshold is a minimum replace with
&lt;em&gt;shortfall&lt;/em&gt;&lt;/p&gt;"><sup>2</sup></a> from the target, and the <strong>length of
time</strong> the <u><em>exceedance</em></u><a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content="&lt;p&gt;if threshold is a minimum replace with
&lt;em&gt;shortfall&lt;/em&gt;&lt;/p&gt;"><sup>3</sup></a> is likely to last.
Higher risk values indicate a greater risk that the scenario will not
achieve the policy objective.</p>
<p>Interpretation of the risk value is more intuitive using a relative
comparator. The policy risk impact in the second row of the table
compares the risk associated with each intervention to the baseline
scenario. The policy risk impact is interpreted as the percent change in
risk relative to the baseline scenario. For example, the expected risk
of <u><em>exceeding</em></u><a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content="&lt;p&gt;if threshold is a minimum replace with &lt;em&gt;falling
below&lt;/em&gt;&lt;/p&gt;"><sup>4</sup></a> the policy target in Intervention 1 is
reduced by 91.30% relative to the baseline scenario.</p>
</div>
</div>
<div class="section level4 unnumbered">
<h4 class="unnumbered" id="standard-description-bullet-points">Standard description bullet points<a class="anchor" aria-label="anchor" href="#standard-description-bullet-points"></a>
</h4>
<div class="rmdnote">
<p>The expected risk values in the first row of the table above
captures:</p>
<ul>
<li><p>The <strong>probability</strong> of the scenario
<u><em>exceeding</em></u><a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content="&lt;p&gt;if threshold is a minimum replace with &lt;em&gt;falling
below&lt;/em&gt;&lt;/p&gt;"><sup>5</sup></a> the specified policy target (i.e., how
likely it is).</p></li>
<li><p>The <strong>magnitude</strong> of the
<u><em>exceedance</em></u><a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content="&lt;p&gt;if threshold is a minimum replace with
&lt;em&gt;shortfall&lt;/em&gt;&lt;/p&gt;"><sup>6</sup></a> from the target.</p></li>
<li><p>The <strong>length of time</strong> the
<u><em>exceedance</em></u><a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content="&lt;p&gt;if threshold is a minimum replace with
&lt;em&gt;shortfall&lt;/em&gt;&lt;/p&gt;"><sup>7</sup></a> is likely to last.</p></li>
<li><p>Higher risk values indicate a greater risk that the scenario will
not achieve the policy objective.</p></li>
</ul>
<p>The policy risk impact in the second row of the table:</p>
<ul>
<li><p>Compares the risk associated with each intervention to the
baseline scenario.</p></li>
<li><p>It is interpreted as the percent change in risk relative to the
baseline scenario.</p></li>
<li><p>For example, the expected risk of <u><em>exceeding</em></u><a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content="&lt;p&gt;if threshold is a minimum replace with &lt;em&gt;falling
below&lt;/em&gt;&lt;/p&gt;"><sup>8</sup></a> the policy
target in Intervention 1 is reduced by 91.5% relative to the baseline
scenario.</p></li>
</ul>
</div>
</div>
</div>
</div>

  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Megan Wiggins, Marie Betsy Varughese, Ellen Rafferty, Sasha van Katwyk, Christopher McCabe, Jeff Round, Erin Kirwin, Institute of Health Economics, Canadian Network for Modelling Infectious Diseases .</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.8.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
